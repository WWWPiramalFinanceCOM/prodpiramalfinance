import{applyLoanNow as z,formInteraction as k,talkToExpert as V}from"../../dl.min.js";import{targetObject as a}from"../../scripts/scripts.min.js";import{branchInput as X,cutomerIncome as Z,cutomerName as ee,cutomerNo as $,formDobInput as te,formLoanAmt as oe,formTc as ne,loanOtpInput as f,loanProduct as H,otpNumChange as re,otpPhoneNum as le,stateInput as j}from"./loanformdom.min.js";import{loanTypeDropdownSelect as ae}from"./utm.min.js";export let overlay,emiOverlay,elgOverlay,loaninnerform,bodyElement;export function createOverlay(l){const c=document.createElement("div");return c.classList.add("overlay"),c.style.zIndex=1209,{hide(){l.querySelector(".overlay").remove()},show(){l.append(c)}}}export let formOverlay={};export function applyLoanFormClick(){loaninnerform=document.querySelector(".loan-form-sub-parent"),loaninnerform=document.querySelector(".loan-form-sub-parent");const l=document.querySelector(".homeloancalculator.block")||document.createElement("div");if(formOverlay=createOverlay(l),loaninnerform){let T=function(e){e.style.display==="block"?e.style.display="none":e.style.display="block"},v=function(e){window.getComputedStyle(e).getPropertyValue("visibility")==="hidden"?e.style.visibility="visible":e.style.visibility="hidden"},s=function(e){e.classList.toggle("inverted")},R=function(e){if((e.target.closest("#statecontainer")&&e.target.classList.contains("subpoints")||i&&!w.contains(e.target)&&!u.contains(e.target))&&(v(u),s(w.querySelector(".arrowimage")),loaninnerform.querySelector("#statecontainer").style.visibility="hidden",i=!1),(e.target.closest("#branchcontainer")&&e.target.classList.contains("subpoints")||m&&!E.contains(e.target)&&!y.contains(e.target))&&(v(y),s(E.querySelector(".arrowimage")),loaninnerform.querySelector("#branchcontainer").style.visibility="hidden",m=!1),e.target.closest(".cmp-form-text")&&e.target.classList.contains("subpoints")||h&&!b.contains(e.target)&&!Q.contains(e.target)){const t=b.nextElementSibling;T(t),s(this.querySelector(".arrowimage")),h=!1}},p=function(){document.querySelector(".applyloanform").querySelectorAll(".loan-form-err").forEach(r=>{r.style.display="none"}),[H(),oe(),ee(),Z(),te(),j(),X(),$()].forEach(r=>r.value=""),ne().checked=!1,document.querySelector("#radio-salary").checked=!0,document.querySelectorAll(".loan-form-button-container .cmp-container").forEach(r=>{r.classList.remove("loan-form-button-active")})},Y=function(e,t){clearInterval(t),clearInterval(d);const o=document.querySelector("#loan-form-resend-otp");d=setInterval(()=>{e>=0?(document.querySelector(".applyloanform .timer").style.display="block",e<=9?document.querySelector(".applyloanform .timer").innerHTML=`00:0${e}`:document.querySelector(".applyloanform .timer").innerHTML=`00:${e}`,e--,o.style.pointerEvents="none"):(clearInterval(t),document.querySelector(".applyloanform .timer").style.display="none",o.style.pointerEvents="unset")},1e3)};const c=document.querySelectorAll(".cmp-form-option-parent");c[0].style.border="1px solid #f26841",c.forEach(e=>{e.addEventListener("click",function(){const t=this.querySelector('input[type="radio"]');t.checked=!0,c.forEach(o=>{o.style.border="1px solid #AFB9C3"}),e.style.border="1px solid #f26841"})});const W=document.querySelectorAll(".crossimage, .failformcross"),G=document.querySelectorAll(".expert");overlay=document.querySelector(".modal-overlay");const q=document.querySelector(".first-form-button .cmp-container");bodyElement=document.body;const ce=document.querySelector(".loan-form-otp-button-container .cmp-container"),J=document.querySelector(".leftarrow"),x=document.querySelector(".cmp-container--documentrequired .cmp-container .extendedbutton"),I=document.querySelector("#loan-banner .cmp-teaser__content .cmp-teaser__action-container .cmp-teaser__action-link"),B=document.getElementById("sticky-btn-loan-form"),A=document.querySelectorAll(".cmp-container--branches .cmp-contentfragmentlist .cmp-contentfragment .cmp-contentfragment__elements .cmp-contentfragment__element--ctaName .cmp-contentfragment__element-value"),N=document.querySelectorAll(".cmp-teaser--open-form-action .cmp-teaser .cmp-teaser__action-container .cmp-teaser__action-link"),C=document.querySelectorAll(".open-form-btn"),L=document.querySelector(".location-link");G.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const o=e.closest("a");if(o&&o.getAttribute("href")){try{const S=t.target?.closest(".section")?.querySelector(".tab-common.active p")?.textContent.trim(),M=t.target?.closest(".section")?.querySelector(".calculator-parent p")?.textContent.trim();t.target.innerText.trim()==="Talk to loan expert"?V("calculator",S,M,a.pageName):t.target.innerText.trim()==="Apply loan now"&&z("calculator",S,M,a.pageName)}catch(S){console.warn(S)}const n=o.getAttribute("href"),r=o.getAttribute("target");r==="_blank"?window.open(n,r):window.location.href=n}else{formOpen(),p(),q.classList.remove("loader-initialized"),loaninnerform.classList.remove("loan-form-sub-otp","loan-form-success","loan-form-request-fail","loan-form-something-wrong");try{const n=t.target?.closest(".section")?.querySelector(".tab-common.active p")?.textContent.trim(),r=t.target?.closest(".section")?.querySelector(".calculator-parent p")?.textContent.trim();t.target.innerText.trim()==="Talk to loan expert"?(V("calculator",n,r,a.pageName),k(n,"Form Open",a.pageName)):t.target.innerText.trim()==="Apply loan now"&&(z("calculator",n,r,a.pageName),k(a.pageName,"Form Open",a.pageName))}catch(n){console.warn(n)}}loaninnerform.querySelector("#statecontainer").style.visibility="hidden",loaninnerform.querySelector("#branchcontainer").style.visibility="hidden"})}),x&&x.addEventListener("click",e=>{e.preventDefault(),formOpen()}),N&&N.forEach(e=>{e.addEventListener("click",()=>{formOpen()})}),C&&C.forEach(e=>{e.addEventListener("click",()=>{formOpen()})}),I&&!L&&I.addEventListener("click",e=>{e.preventDefault(),formOpen()}),B&&!L&&B.addEventListener("click",e=>{formOpen()}),A&&!L&&A.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault(),formOpen()})}),ae(),W.forEach(e=>{e.addEventListener("click",t=>{t.stopImmediatePropagation();try{k(a.pageName,"Form Close",a.pageName)}catch(n){console.warn(n)}const o=document.querySelector(".home-page-calculator-call-xf");o?o.querySelector(".homeloancalculator-wrapper .show")||o.querySelector(".eligibilitycalculator-wrapper .show")?(loaninnerform.querySelector("#statecontainer").style.visibility="hidden",loaninnerform.querySelector("#branchcontainer").style.visibility="hidden",loaninnerform.style.visibility="hidden",overlay.style.zIndex="1111",loaninnerform.classList.contains("loan-form-success")&&(loaninnerform.classList.remove("loan-form-success"),loaninnerform.classList.remove("loan-form-sub-otp"))):(loaninnerform.classList.remove("loan-form--open"),document.querySelector(".modal-overlay").classList.remove("overlay"),document.querySelector(".modal-overlay").classList.add("dp-none"),loaninnerform.querySelector("#statecontainer").style.visibility="hidden",loaninnerform.querySelector("#branchcontainer").style.visibility="hidden",bodyElement.style.overflowY="auto",loaninnerform.style.visibility="hidden",p(),loaninnerform.classList.remove("loan-form-sub-otp","loan-form-success","loan-form-request-fail","loan-form-something-wrong"),loaninnerform.classList.contains("loan-form-success")&&(loaninnerform.classList.remove("loan-form-success"),loaninnerform.classList.remove("loan-form-sub-otp"))):(loaninnerform.classList.remove("loan-form--open"),document.querySelector(".modal-overlay").classList.remove("overlay"),document.querySelector(".modal-overlay").classList.add("dp-none"),loaninnerform.querySelector("#statecontainer").style.visibility="hidden",loaninnerform.querySelector("#branchcontainer").style.visibility="hidden",bodyElement.style.overflowY="auto",loaninnerform.style.visibility="hidden",loaninnerform.classList.contains("loan-form-success")&&(loaninnerform.classList.remove("loan-form-success"),loaninnerform.classList.remove("loan-form-sub-otp"))),p(),loaninnerform.classList.remove("loan-form-sub-otp","loan-form-success","loan-form-request-fail","loan-form-something-wrong")})}),q&&q.addEventListener("click",()=>{loaninnerform.classList.add("loan-form-sub-otp"),le().textContent=$().value,document.querySelector(".wrongotpmessage").style.display="none",Y(D,P);const e=document.querySelector(".applyloanform .timer");e&&(e.style.display="block"),f().value="",document.querySelector("#otp-digits").textContent="0/4 Digits"});const O=document.querySelector("#loan-form-resend-otp");O&&O.addEventListener("click",()=>{Y(D,P)}),J.addEventListener("click",e=>{loaninnerform.classList.remove("loan-form-sub-otp"),document.querySelector(".wrongotpmessage").style.display="none",clearInterval(d),f().value=""});const K=document.querySelector(".loan-form-sub-parent .cmp-container");emiOverlay=document.querySelector(".cmp-container--emicaloverlay"),elgOverlay=document.querySelector(".cmp-container--elgcaloverlay"),loaninnerform.addEventListener("click",e=>{if(e.target.classList.contains("subpoints")){const t=e.target.dataset.getInput,o=document.querySelector(`#${t}`);if(o.value=e.target.textContent.trim(),o.id=="form-loan-type"){const{loanType:n,loanName:r}=e.target.dataset;o.dataset.loanType=n,o.dataset.loanName=r,j().value="",H().dispatchEvent(new Event("change"))}o.id!="form-loan-type"&&(o.dispatchEvent(new Event("change")),o.classList.add("place-selected")),o.dispatchEvent(new Event("input",{bubbles:!0}));return}K.contains(e.target)||(emiOverlay||elgOverlay?emiOverlay.classList.contains("show")||elgOverlay.classList.contains("show")?(loaninnerform.querySelector("#statecontainer").style.visibility="hidden",loaninnerform.querySelector("#branchcontainer").style.visibility="hidden",loaninnerform.style.visibility="hidden",overlay.style.zIndex="1000"):(document.querySelector(".modal-overlay").classList.remove("overlay"),document.querySelector(".modal-overlay").classList.add("dp-none"),loaninnerform.querySelector("#statecontainer").style.visibility="hidden",loaninnerform.querySelector("#branchcontainer").style.visibility="hidden",loaninnerform.style.visibility="hidden",document.body.style.overflowY="auto",p(),clearInterval(d),f().value="",loaninnerform.classList.remove("loan-form-sub-otp","loan-form-success","loan-form-request-fail","loan-form-something-wrong")):(document.querySelector(".modal-overlay").classList.remove("overlay"),document.querySelector(".modal-overlay").classList.add("dp-none"),loaninnerform.querySelector("#statecontainer").style.visibility="hidden",loaninnerform.querySelector("#branchcontainer").style.visibility="hidden",loaninnerform.style.visibility="hidden",document.body.style.overflowY="auto",p(),clearInterval(d),f().value="",loaninnerform.classList.remove("loan-form-sub-otp","loan-form-success","loan-form-request-fail","loan-form-something-wrong")))}),overlay.addEventListener("click",e=>{window.matchMedia("(max-width: 1024px)").matches&&(document.querySelector(".modal-overlay").classList.remove("overlay"),document.querySelector(".modal-overlay").classList.add("dp-none"),loaninnerform.querySelector("#statecontainer").style.visibility="hidden",loaninnerform.querySelector("#branchcontainer").style.visibility="hidden",loaninnerform.style.visibility="hidden",bodyElement.style.overflowY="auto")});const u=document.getElementById("statecontainer"),w=document.getElementById("stateparent"),y=document.getElementById("branchcontainer"),E=document.getElementById("branchparent"),b=document.querySelector(".multiselectoptions"),Q=b.nextElementSibling;let i=!1,m=!1,h=!1;document.addEventListener("click",R);const F=document.querySelector("#branchparent .arrowimage");w.addEventListener("click",function(e){y.style.visibility="hidden",F.classList.remove("inverted"),m=!1,v(u),s(this.querySelector(".arrowimage")),i=!i,e.stopPropagation()});const _=document.querySelector("#stateparent .arrowimage");E.addEventListener("click",function(e){u.style.visibility="hidden",_.classList.remove("inverted"),i=!1,v(y),s(this.querySelector(".arrowimage")),m=!m,e.stopPropagation()}),b.addEventListener("click",function(e){y.style.visibility="hidden",F.classList.remove("inverted"),m=!1,u.style.visibility="hidden",_.classList.remove("inverted"),i=!1;const t=this.nextElementSibling;T(t),s(this.querySelector(".arrowimage")),h=!h,e.stopPropagation()});const U=document.getElementById("loanformcheck"),g=document.querySelector(".circle");U.addEventListener("change",function(){this.checked?(g.classList.add("movecircle"),g.classList.remove("animate")):(g.classList.remove("movecircle"),g.classList.add("animate"))});let D=30,P,d;re().addEventListener("click",()=>{document.querySelector(".loan-form-sub-parent").classList.remove("loan-form-sub-otp"),document.querySelector(".wrongotpmessage").style.display="none",clearInterval(d),f().value=""})}}export function formOpen(){if(window.matchMedia("(max-width: 1024px)").matches)document.querySelector(".modal-overlay").classList.add("overlay"),document.querySelector(".modal-overlay").classList.remove("dp-none"),loaninnerform.classList.add("loan-form--open"),loaninnerform.style.visibility="visible",bodyElement.style.overflowY="hidden";else{document.querySelector(".modal-overlay").classList.add("overlay"),document.querySelector(".modal-overlay").classList.remove("dp-none");const l=document.querySelector(".home-page-calculator-call-xf");l&&(l.querySelector(".homeloancalculator-wrapper .show")||l.querySelector(".eligibilitycalculator-wrapper .show"))&&(overlay.style.zIndex="1205"),loaninnerform.style.visibility="visible",bodyElement.style.overflowY="hidden"}}window.addEventListener("pageshow",l=>{l.persisted&&window.location.reload()});
