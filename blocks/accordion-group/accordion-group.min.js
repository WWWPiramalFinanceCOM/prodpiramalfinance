import{ctaClick as l,ctaClickInteraction as a,documentRequiredInteraction as u,faqInteraction as f}from"../../dl.min.js";import{fetchPlaceholders as m}from"../../scripts/aem.min.js";import{targetObject as d}from"../../scripts/scripts.min.js";import{documentRequired as p,generateAccordionDOM as q}from"../accordion/accordion.min.js";const h=[];export default async function y(n){const c=await m();[...[...n.children]].forEach(t=>{const o=q(t);if(t.textContent="",t.classList.add("accordion","block"),t.append(o),t.closest(".section.faq-section-wrapper")){let r=t?.querySelector("summary >div >p")?.textContent?.trim()||"",s=(t?.querySelector("details >div")?.textContent?.trim()||"")?.replace(/\s+/g," ")?.trim()?.replace(/\n/g," ")||"";h.push({"@type":"Question",name:r,acceptedAnswer:{"@type":"Answer",text:s}})}try{C(o)}catch(r){console.warn(r)}}),n.classList.add("shade-box");try{x(n),n.closest(".faq-view-more-logic")&&w(),document.querySelector(".documents-required-brown")&&p()}catch(t){console.warn(t)}}function x(n){const c=n.querySelectorAll("details summary");c.forEach(e=>{e.addEventListener("click",function(t){if(this.classList.contains("active"))setTimeout(()=>{this.closest("details").removeAttribute("open")}),this.classList.remove("active");else{c.forEach(o=>{o.closest("details").removeAttribute("open"),o.classList.remove("active")});try{const o={};if(e.closest(".documents-required-brown")){o.click_text=e.querySelector("h3").textContent.trim(),u(o);const r=e.querySelector("h3").textContent.trim(),i="",s=e.closest(".section").querySelector(".default-content-wrapper").querySelector("h1, h2, h3, h4, h5, h6").textContent.trim();l(r,s,i,d.pageName)}else o.click_text=e.textContent.trim(),f(o)}catch(o){console.warn(o)}this.classList.toggle("active")}})})}function w(){document.querySelectorAll(".faq-section-wrapper.faq-view-more-logic").forEach(n=>{n.querySelectorAll(".accordion.block").forEach((t,o)=>{o==5&&t.classList.add("faq-blur"),t.classList.toggle("dp-none",o>5)});const e=n.querySelector(".button-container");if(e){const t=e.querySelector("a").textContent.trim();e.innerHTML=t,S(n)}})}function S(n){n.querySelector(".faq-section-wrapper .button-container").addEventListener("click",function(){try{const t={};t.click_text=this.textContent.trim(),t.cta_position=this.closest(".section").querySelector(".default-content-wrapper").querySelector("h1, h2, h3, h4, h5, h6").textContent.trim(),a(t)}catch(t){console.warn(t)}const e=this.textContent.toLowerCase()==="view more";this.innerText=e?"View Less":"View More",n.querySelectorAll(".accordion.block").forEach((t,o)=>{o==5&&(t.classList.contains("faq-blur")?t.classList.remove("faq-blur"):t.classList.add("faq-blur")),t.classList.toggle("dp-none",!e&&o>5)})})}function C(n){n.querySelectorAll("ul > li > a").forEach(c=>{c.addEventListener("click",function(){const e={};e.click_text=this.textContent.trim(),e.cta_position=this.closest(".accordion").querySelector("summary").textContent.trim(),a(e)})})}function b(n){let c={"@context":"https://schema.org","@type":"FAQPage",mainEntity:n};const e=document.createElement("script");e.type="application/ld+json",e.innerHTML=JSON.stringify(c)||"",document.head.append(e)}
